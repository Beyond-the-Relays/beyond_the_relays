
namespace = btr_asari_writings

# Initial Popup
country_event = {
	id = btr_asari_writings.1
	title = btr_asari_writings.1.name
	desc = {
		text = btr_asari_writings.1.a.desc # Is Asari Desc 
		trigger = {
			has_country_flag = asari_republics
		}
	}
	desc = {
		text = btr_asari_writings.1.b.desc # Contact Republics
		trigger = {
			NOR = {
				has_country_flag = asari_republics
				has_country_flag = asari_corp
			}
		}
	}
	picture = btr_GFX_evt_writings_thessia
	is_triggered_only = yes
	trackable = yes
	trigger = {
		OR = {
			has_country_flag = asari_republics
			has_country_flag = asari_corp
			has_established_contact = event_target:asari_republics
		}
		NOT = {
			has_country_flag = asari_writings_event
		}
	}
	immediate = {
		set_country_flag = asari_writings_event
		set_global_flag = asari_writings_event
	}
	option = {
		name = btr_asari_writings.1.a
		begin_event_chain = {
			event_chain = "asari_writings_chain"
			target = ROOT
		}
		hidden_effect = {
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 50 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 25 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 10 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_1"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 50 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 25 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 10 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_2"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 75 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 50 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 25 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_3"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					num_moons >= 3
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 75 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 50 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 25 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_4"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 100 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 75 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 50 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_5"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 125 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 100 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 75 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_6"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 150 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 125 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 100 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_7"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 175 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 150 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 125 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_8"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					OR = {
						is_planet_class = pc_barren
						is_planet_class = pc_barren_cold
					}
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 200 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 150 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 100 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_9"
					location = THIS
					owner = root
				}
			}
			random_planet = {
				limit = {
					is_star = no
					is_capital = no
					is_colony = no
					NOT = { is_planet_class = pc_gas_giant }
					solar_system = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = {
									NOT = { is_country_type = fallen_empire }
									NOT = { is_country_type = awakened_fallen_empire }
									NOR = {
										has_country_flag = geth_consensus
										has_country_flag = rachni_hive
										has_country_flag = collectors
									}
								}
							}
						}
					}
				}
				weights = {
					base = 1
					modifier = { add = 1000 distance = { source = root.capital_scope max_distance >= 250 } }
					modifier = { add = 500 distance = { source = root.capital_scope max_distance >= 200 } }
					modifier = { add = 250 distance = { source = root.capital_scope max_distance >= 175 } }
				}
				enable_special_project = {
					name = "ASARI_WRITINGS_10"
					location = THIS
					owner = root
				}
			}
		}
	}
	option = {
		name = btr_asari_writings.1.b
		trigger = {
			has_country_flag = asari_republics
		}
	}
	option = {
		name = btr_asari_writings.1.c
		trigger = {
			NOT = { has_country_flag = asari_republics }
		}
		hidden_effect = {
			if = {
				limit = {
					exists = event_target:asari_republics
				}
				event_target:asari_republics = {
					country_event = { id = btr_asari_writings.1 }
				}
			}
		}
	}
}

# Asari Writings 1
ship_event = {
	id = btr_asari_writings.2
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.2.desc
	picture = btr_GFX_evt_writings_surface_4
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 2
ship_event = {
	id = btr_asari_writings.3
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.3.desc
	picture = btr_GFX_evt_planet_orbit_1
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 3
ship_event = {
	id = btr_asari_writings.4
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.4.desc
	picture = btr_GFX_evt_planet_orbit_4
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 4
ship_event = {
	id = btr_asari_writings.5
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.5.desc
	picture = btr_GFX_evt_planet_orbit_11
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 5
ship_event = {
	id = btr_asari_writings.6
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.6.desc
	picture = btr_GFX_evt_planet_orbit_7
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 6
ship_event = {
	id = btr_asari_writings.7
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.7.desc
	picture = btr_GFX_evt_writings_surface_3
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			add_resource = {
				minor_artifacts = 5
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 7
ship_event = {
	id = btr_asari_writings.8
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.8.desc
	picture = btr_GFX_evt_planet_orbit_5
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 8
ship_event = {
	id = btr_asari_writings.9
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.9.desc
	picture = btr_GFX_evt_planet_orbit_9
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 9
ship_event = {
	id = btr_asari_writings.10
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.10.desc
	picture = btr_GFX_evt_writings_surface_2
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			add_resource = {
				alloys = 25
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# Asari Writings 10
ship_event = {
	id = btr_asari_writings.11
	title = btr_asari_writings.2.name
	desc = btr_asari_writings.11.desc
	picture = btr_GFX_evt_writings_surface_1
	location = fromfrom
	is_triggered_only = yes
	option = {
		name = "EXCELLENT"
		owner = {
			add_event_chain_counter = { 
				event_chain = "asari_writings_chain" 
				counter = "writings_collected" 
				amount = 1 
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			hidden_effect = {
				if = {
					limit = {
						has_completed_event_chain_counter = {
							event_chain = "asari_writings_chain" 
							counter = "writings_collected" 
						}
						NOT = { has_country_flag = all_asari_writings_collected }
					}
					country_event = { id = btr_asari_writings.100 }
				}
			}
		}
	}
}

# All Asari Writings Collected - TODO get Relic
country_event = {
	id = btr_asari_writings.100
	title = btr_asari_writings.100.name
	desc = {
		text = btr_asari_writings.100.a.desc # Is Asari Desc 
		trigger = {
			has_country_flag = asari_republics
		}
	}
	desc = {
		text = btr_asari_writings.100.b.desc # Not Asari Rep
		trigger = {
			NOR = {
				has_country_flag = asari_republics
				has_country_flag = asari_corp
			}
		}
	}
	picture = btr_GFX_evt_writings_thessia
	is_triggered_only = yes
	trigger = {
		has_completed_event_chain_counter = {
			event_chain = "asari_writings_chain"
			counter = "writings_collected"
		}
		NOT = { has_country_flag =  all_asari_writings_collected }
	}
	immediate = {
		set_country_flag =  all_asari_writings_collected
		root = {
			save_event_target_as = asari_writings_finder
		}
	}
	option = {
		name = btr_asari_writings.100.a
		trigger = {
			has_country_flag = asari_republics
		}
		end_event_chain = "asari_writings_chain"
		add_relic = r_asari_writings
	}
	option = {
		name = btr_asari_writings.100.b # Contact Asari - TODO get Relic
		trigger = {
			NOT = { has_country_flag = asari_republics }
		}
		end_event_chain = "asari_writings_chain"
		hidden_effect = {
			country_event = { id = btr_asari_writings.12 }
			event_target:asari_republics = {
				country_event = { id = btr_asari_writings.13 days = 20 } # change
			}
		}
		add_relic = r_asari_writings
	}
	option = {
		name = btr_asari_writings.100.c # Keep to self - TODO get Relic
		trigger = {
			NOT = { has_country_flag = asari_republics }
		}
		end_event_chain = "asari_writings_chain"
		add_relic = r_asari_writings
	}
}

# Return Relic - Diplo from player finder
country_event = {
	id = btr_asari_writings.12
	title = btr_asari_writings.12.name # asari republics getname
	desc = btr_asari_writings.12.desc # thanking player for return
	picture_event_data = {
		portrait = event_target:asari_republics
		room = asari_rep_room
	}
	is_triggered_only = yes
	force_open = yes
	diplomatic = yes
	option = {
		name = btr_asari_writings.12.a # Our pleasure - TODO add opinion modifier 
		event_target:asari_republics = {
			add_opinion_modifier = {
				who = root
				modifier = asari_writings_returned
			}
		}
		add_favors = {
			target = event_target:asari_republics
			value = 1
		}
		remove_relic = r_asari_writings
		default_hide_option = yes
	}
}

# Return Relic - Asari receives
country_event = {
	id = btr_asari_writings.13
	title = btr_asari_writings.13.name
	desc = btr_asari_writings.13.desc
	picture = btr_GFX_evt_writings_thessia
	is_triggered_only = yes
	trigger = {
		has_country_flag = asari_republics
	}
	option = {
		name = btr_asari_writings.13.a
		add_relic = r_asari_writings
	}
}

