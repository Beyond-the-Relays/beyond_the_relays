
namespace = noveria

# Invest in noveria peak - initial popup
country_event = {
	id = noveria.1
	title = noveria.1.name
	desc = noveria.1.desc
	picture_event_data = {
		portrait = event_target:noveria_development_corporation
		room = noveria_room
	}
	is_triggered_only = yes
	force_open = yes
	diplomatic = yes
	trigger = {
		exists = event_target:noveria_development_corporation
		event_target:noveria_development_corporation = {
			is_country_type = primitive
		}
		NOT = { has_country_flag = noveria_invest_initial }
		has_established_contact = event_target:noveria_development_corporation
	}
	immediate = {
		set_country_flag = noveria_invest_initial
		set_global_flag = noveria_invest_initial
	}

	option = {
		name = noveria.1.a # Invest in expensive facility
		allow = {
			has_resource = { type = energy amount >= 5000 }
		}
		add_resource = { energy = -5000 }
		add_modifier = { modifier = noveria_peak_21 }
		hidden_effect = {
			set_country_flag = noveria_expensive_facility
			country_event = { id = noveria.2 days = 30 scopes = { from = event_target:noveria_development_corporation } }
			random_planet = {
				limit = {
					has_planet_flag = btr_planet_noveria
				}
				add_deposit = d_noveria_peak_research_facility
			}
		}
		response_text = noveria.1.a.response
		default_hide_option = yes
		custom_tooltip = noveria.1.a.tooltip
	}
	option = {
		name = noveria.1.b # Invest in moderate facility
		allow = {
			has_resource = { type = energy amount >= 2500 }
		}
		add_resource = { energy = -2500 }
		add_modifier = { modifier = noveria_peak_8 }
		hidden_effect = {
			set_country_flag = noveria_moderate_facility
			country_event = { id = noveria.2 days = 30 scopes = { from = event_target:noveria_development_corporation } }
			random_planet = {
				limit = {
					has_planet_flag = btr_planet_noveria
				}
				add_deposit = d_noveria_peak_research_facility
			}
		}
		response_text = noveria.1.b.response
		default_hide_option = yes
		custom_tooltip = noveria.1.b.tooltip
	}
	option = {
		name = noveria.1.c # Not interested
		hidden_effect = {
			set_country_flag = noveria_not_interested
		}
		response_text = noveria.1.c.response
		default_hide_option = yes
	}
}

# Choose what research to focus on
country_event = {
	id = noveria.2
	title = noveria.2.name
	desc = noveria.2.desc
	picture_event_data = {
		portrait = event_target:noveria_scientist
		room = noveria_lab_room
	}
	is_triggered_only = yes
	force_open = yes
	diplomatic = yes
	immediate = {
		ensure_country_noveria_scientist_exists = { target = "noveria_scientist" leadertype = "civilianLeader"  }
		event_target:noveria_scientist = {
			save_global_event_target_as = new_noveria_scientist
		}
	}

	option = {
		name = noveria.2.a # weapons research
		hidden_effect = {
			set_country_flag = noveria_weapons_research
			country_event = { id = noveria.3 days = 3650 random = 500 scopes = { from = event_target:noveria_development_corporation } }
		}
		response_text = noveria.2.a.response
		default_hide_option = yes
	}
	option = {
		name = noveria.2.b # genetic augmentation
		hidden_effect = {
			set_country_flag = noveria_genetic_research
			country_event = { id = noveria.3 days = 3650 random = 500 scopes = { from = event_target:noveria_development_corporation } }
		}
		response_text = noveria.2.b.response
		default_hide_option = yes
	}
}

# Follow up - branch event - HIDDEN - 
country_event = {
	id = noveria.3
	title = noveria.3.name
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = event_target:noveria_development_corporation
		event_target:noveria_development_corporation = {
			is_country_type = primitive
		}
	}
	immediate = {
		random_list = {
			50 = { 
			   modifier = { add = 20 has_country_flag = noveria_expensive_facility }  # good
			   if = {
				   limit = { has_country_flag = noveria_weapons_research }
				   country_event = { id = noveria.4 scopes = { from = from } }
			   }
			   if = {
				   limit = { has_country_flag = noveria_genetic_research }
				   country_event = { id = noveria.5 scopes = { from = from } }
			   }
		    }
			50 = {
				if = {
					limit = { has_country_flag = noveria_weapons_research }
					country_event = { id = noveria.6 scopes = { from = from } }
				}
				if = {
					limit = { has_country_flag = noveria_genetic_research }
					country_event = { id = noveria.7 scopes = { from = from } }
				}
			}
		}
	}
}

# Good - Weapons - Scientists report breakthrough or something?
country_event = {
	id = noveria.4
	title = noveria.4.name
	desc = noveria.4.desc
	picture = btr_GFX_evt_noveria_peak_15
	is_triggered_only = yes
	
	option = {
		name = noveria.4.a
		add_resource = {
			physics_research = 2500
			engineering_research = 2500
		}
		if = {
			limit = { NOT = { has_technology = tech_mass_drivers_3 } }
			give_technology = { tech = tech_mass_drivers_3 }
		}
		add_modifier = {
			modifier = weapon_research_inspired
			years = 10
		}
	}
}

# Good - Genetics
country_event = {
	id = noveria.5
	title = noveria.4.name
	desc = noveria.5.desc
	picture = btr_GFX_evt_noveria_peak_15
	is_triggered_only = yes

	option = {
		name = noveria.4.a
		add_resource = {
			society_research = 2500
		}
		if = {
			limit = { NOT = { has_technology = tech_gene_tailoring } }
			give_technology = {
				tech = tech_gene_tailoring
			}
		}
		add_modifier = {
			modifier = genetic_research_inspired
			years = 10
		}
	}
}

# Bad - Weapons - Facility blows up 
country_event = {
	id = noveria.6
	title = noveria.6.name
	desc = noveria.6.desc
	picture = btr_GFX_evt_noveria_peak_15
	is_triggered_only = yes

	option = {
		name = noveria.6.a
		if = {
			limit = { has_modifier = noveria_peak_8 }
			remove_modifier = noveria_peak_8
		}
		if = {
			limit = { has_modifier = noveria_peak_21 }
			remove_modifier = noveria_peak_21
		}
		hidden_effect = {
			random_planet = {
				limit = { has_planet_flag = btr_planet_noveria }
				remove_deposit = d_noveria_peak_research_facility
			}
		}
	}
}

# Bad - Genetics - Dangerous Mutagen - purge facility
country_event = {
	id = noveria.7
	title = noveria.7.name
	desc = noveria.7.desc
	picture = btr_GFX_evt_noveria_peak_15
	is_triggered_only = yes

	option = {
		name = noveria.7.a
		if = {
			limit = { has_modifier = noveria_peak_8 }
			remove_modifier = noveria_peak_8
		}
		if = {
			limit = { has_modifier = noveria_peak_21 }
			remove_modifier = noveria_peak_21
		}
		hidden_effect = {
			random_planet = {
				limit = { has_planet_flag = btr_planet_noveria }
				remove_deposit = d_noveria_peak_research_facility
			}
		}
	}
}

# Have NDC diplo event saying about destruction of facility - saying they can no long work on noveria