
namespace = btr_setup

# Kill Vanilla Countries
event = {
	id = btr_setup.100
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		every_country = {
			limit = {
				is_country_type = default
				NOT = { has_country_flag = btr_empire }
				is_ai = yes
			}
			erase_invalid_spawn_system = yes
		}
	}
}

# Add starting resources
country_event = {
	id = btr_setup.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		add_resource = { energy = 100	}
		add_resource = { minerals = 100 }
		add_resource = { alloys = 100	}
		add_resource = { influence = 100 }
		add_resource = { food = 200	}
		add_resource = { consumer_goods = 100 }
	}
}

country_event = {
    id = btr_setup.2
    hide_window = yes
    #fire_only_once = yes
	is_triggered_only = yes
	
    immediate = {
		# If any "canon" asari planets exist, save their owners
		random_country = {
			limit = {
				has_origin = mec_asari_origin_thessia
			}
			save_event_target_as = mec_asari_thessia_country
			species = { save_event_target_as = mec_asari_thessia_species }
		}
		random_country = {
			limit = {
				has_origin = mec_asari_origin_illium
			}
			save_event_target_as = mec_asari_illium_country
			species = { save_event_target_as = mec_asari_illium_species }
		}
		random_country = {
			limit = {
				has_origin = origin_omega
			}
			save_event_target_as = btr_asari_omega_country
			species = { save_event_target_as = btr_asari_omega_species }
		}
		# Check for the first "canon" asari species generated by the game.
		# This is to make sure it's folded into the main species on the list instead of being shown in the drop-down.
		every_country = {
			limit = {
				OR = {
					is_same_value = event_target:mec_asari_thessia_country
					is_same_value = event_target:mec_asari_illium_country
					is_same_value = event_target:btr_asari_omega_country
				}
			}
			if = {
				limit = {
					NOT = { exists = event_target:mec_asari_main_country }
				}
				save_global_event_target_as = mec_asari_main_country
				species = { save_global_event_target_as = mec_asari_main_species }
				# If Thessia exists, set it as the main asari species homeworld
				if = {
					limit = {
						exists = event_target:mec_asari_planet_thessia
					}
					event_target:mec_asari_main_species = {
						set_species_homeworld = event_target:mec_asari_planet_thessia
					}
				}
			}
		}
		# Check for duplicate asari offshots and merge them all into one species
		every_country = {
			if = {
				limit = {
					exists = event_target:mec_asari_main_country
					OR = {
						species = { is_same_value = event_target:mec_asari_thessia_species }
						species = { is_same_value = event_target:mec_asari_illium_species }
						species = { is_same_value = event_target:btr_asari_omega_species }
					}
				}
				change_dominant_species = {
					species = event_target:mec_asari_main_species
					change_all = yes
				}
			}
		}
    }
}

country_event = {
    id = btr_setup.201
    hide_window = yes
    #fire_only_once = yes
	is_triggered_only = yes
	
    immediate = {
		# If any "canon" asari planets exist, save their owners
		random_country = {
			limit = {
				has_origin = origin_salarian_union
			}
			save_event_target_as = btr_salarian_union_country
			species = { save_event_target_as = btr_salarian_surkesh_species }
		}
		random_country = {
			limit = {
				has_origin = origin_noveria_development_corporation
			}
			save_event_target_as = btr_noveria_development_corporation_country
			species = { save_event_target_as = btr_salarian_noveria_species }
		}
		# Check for the first "canon" asari species generated by the game.
		# This is to make sure it's folded into the main species on the list instead of being shown in the drop-down.
		every_country = {
			limit = {
				OR = {
					is_same_value = event_target:btr_salarian_union_country
					is_same_value = event_target:btr_noveria_development_corporation_country
				}
			}
			if = {
				limit = {
					NOT = { exists = event_target:btr_salarian_main_country }
				}
				save_global_event_target_as = btr_salarian_main_country
				species = { save_global_event_target_as = btr_salarian_main_species }
				# If Thessia exists, set it as the main asari species homeworld
				if = {
					limit = {
						exists = event_target:btr_salarian_planet_surkesh
					}
					event_target:btr_salarian_main_species = {
						set_species_homeworld = event_target:btr_salarian_planet_surkesh
					}
				}
			}
		}
		# Check for duplicate asari offshots and merge them all into one species
		every_country = {
			if = {
				limit = {
					exists = event_target:btr_salarian_main_country
					OR = {
						species = { is_same_value = event_target:btr_salarian_surkesh_species }
						species = { is_same_value = event_target:btr_salarian_noveria_species }
					}
				}
				change_dominant_species = {
					species = event_target:btr_salarian_main_species
					change_all = yes
				}
			}
		}
    }
}

country_event = {
    id = btr_setup.202
    hide_window = yes
    #fire_only_once = yes
	is_triggered_only = yes
	
    immediate = {
		# If any "canon" asari planets exist, save their owners
		random_country = {
			limit = {
				has_origin = origin_systems_alliance
			}
			save_event_target_as = btr_systems_alliance_country
			species = { save_event_target_as = btr_human_earth_species }
		}
		random_country = {
			limit = {
				has_origin = origin_cerberus
			}
			save_event_target_as = btr_cerberus_country
			species = { save_event_target_as = btr_human_cronos_species }
		}
		# Check for the first "canon" asari species generated by the game.
		# This is to make sure it's folded into the main species on the list instead of being shown in the drop-down.
		every_country = {
			limit = {
				OR = {
					is_same_value = event_target:btr_systems_alliance_country
					is_same_value = event_target:btr_human_cronos_species
				}
			}
			if = {
				limit = {
					NOT = { exists = event_target:btr_human_main_country }
				}
				save_global_event_target_as = btr_human_main_country
				species = { save_global_event_target_as = btr_human_main_species }
				# If Thessia exists, set it as the main asari species homeworld
				if = {
					limit = {
						exists = event_target:btr_human_planet_earth
					}
					event_target:btr_human_main_species = {
						set_species_homeworld = event_target:btr_human_planet_earth
					}
				}
			}
		}
		# Check for duplicate asari offshots and merge them all into one species
		every_country = {
			if = {
				limit = {
					exists = event_target:btr_human_main_country
					OR = {
						species = { is_same_value = event_target:btr_human_earth_species }
						species = { is_same_value = event_target:btr_human_cronos_species }
					}
				}
				change_dominant_species = {
					species = event_target:btr_human_main_species
					change_all = yes
				}
			}
		}
    }
}

# Set Volus as Protectorate
country_event = {
	id = btr_setup.3
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_country_flag = vol_protectorate
	}
	immediate = {
		if = {
			limit = { exists = event_target:vol_protectorate exists = event_target:turian_hierarchy }
			event_target:vol_protectorate = {
				establish_communications_no_message = event_target:turian_hierarchy
				set_subject_of = { who = event_target:turian_hierarchy subject_type = special_protectorate }
			}
		}
	}
}

# this: capital planet
# from: founder species
planet_event = {
	id = btr_setup.4
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = {
				NOR = {
					has_planet_flag = btr_systems_alliance_planet_earth
					has_planet_flag = btr_systems_alliance_planet_mars
					has_planet_flag = btr_collectors_collector_station
					has_planet_flag = btr_cerberus_cronos_station
				}
			}
			generate_btr_start_deposits_and_blockers = yes
		}
	}
}


# Omega Setup continued
country_event = {
	id = btr_setup.6
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		every_owned_pop_species = {
			limit = {
				NOR = { 
					is_species_class = MECASA 
				}
			}
			set_citizenship_type = { country = root type = citizenship_full cooldown = no }
			set_living_standard = { country = root type = living_standard_normal cooldown = no }
		}
	}
}

# Set Minor Empires
country_event = {
	id = btr_setup.7
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = {
				has_country_flag = btr_minor
			}
			add_modifier = {
				modifier = btr_minor_empire
				days = 10950
			}
			limit = {
				has_country_flag = independent_colony
			}
			add_modifier = {
				modifier = btr_independent_colony
				days = -1
			}
		}
	}
}

country_event = {
	id = btr_setup.8
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { 
				has_country_flag = parnack_regime_player 
			}
			random_owned_planet = {
					limit = {
						has_planet_flag = parnack_planet
					}
				generate_btr_parnack_regime_capitol_buildings = yes
			}
		}
	}
}

#Pregame Genocide
country_event = {
	id = btr_setup.9
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { is_ai = no }
			every_country = {
				every_owned_pop = {
					limit = { NOT = { has_pop_flag = init_spawn } }
					kill_pop = yes
				}
				every_country = {
					every_owned_planet = {
						check_planet_employment = yes				
					}
				}	 	 
			}
		}
	}
}